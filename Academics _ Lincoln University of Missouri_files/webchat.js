!function(){"use strict";function t(t){return t.endsWith(".dev.mainstay.com")?"chat.dev.mainstay.com":t.endsWith(".staging.mainstay.com")?"chat.staging.mainstay.com":t.endsWith(".mainstay.com")&&"chat.mainstay.com"!==t||t.endsWith(".admithub.com")?"chat.mainstay.com":t}function n(){const t=document.querySelectorAll("script[src]");for(const n of t){const t=n.src;if(t.includes("/static/js/webchat.js")||t.includes("ms-embed.js")||t.includes("mainstay.com")||t.includes("admithub.com"))return t}return window.location.href}function e(){let t=document.currentScript;if(!t){const n=document.querySelectorAll('script[src*="ms-embed"], script[src*="embed-minimal"]');t=n[n.length-1]}if(!t?.src)return null;const n=new URL(t.src).searchParams;let e=n.get("botToken");const o=n.get("institutionId");if(!e)try{window.admitHubBot?.botToken&&(e=window.admitHubBot.botToken)}catch{}return e?{botToken:e,institutionId:o??void 0}:null}async function o(e){const o=document.querySelector(`webchat-widget[bot-token="${e.botToken}"]`);if(o)return o;customElements.get("webchat-widget")||await async function(){const e=document.createElement("script");e.type="module";const o=n();let c;if(o.includes("mainstay.com")||o.includes("admithub.com")){const n=new URL(o),e=t(n.host);c=`${n.protocol}//${e}/assets/webchat-widget.js`}else c="/src/web-component.tsx";return e.src=c,new Promise(((n,c)=>{e.onload=()=>n(),e.onerror=n=>{if(!e.src.includes("webchat-widget.js"))return void c(new Error(`Failed to load script: ${n instanceof Error?n.message:"Unknown error"}`));const i=new URL(o),s=t(i.host),r=`${i.protocol}//${s}/assets/webchat-widget.js`;r===e.src?c(new Error(`Failed to load script with fallback: ${n instanceof Error?n.message:"Unknown error"}`)):e.src=r},document.head.appendChild(e)}))}();const c=document.createElement("webchat-widget");return c.setAttribute("bot-token",e.botToken),e.institutionId&&c.setAttribute("institution-id",e.institutionId),document.body.appendChild(c),c}window.__getAssetUrl=function(e){let o="https://chat.mainstay.com";try{const e=n();if(e!==window.location.href){const n=new URL(e),c=t(n.hostname);o=`${n.protocol}//${c}`}}catch{}return o+(e.startsWith("/")?e:`/${e}`)},"undefined"!=typeof window&&(window.WebChatEmbed={init:o,getConfig:e}),function(){const t=e();t&&("loading"===document.readyState?document.addEventListener("DOMContentLoaded",(()=>{o(t)})):o(t))}()}();
